# SELinux
Security Enhanced Linux - система принудительного ( мандатного) контроля доступа     

__SELinux - особенности__
- Сложная система политик
- Непонятное разделение ответственности за создание политик
- Каждый ресурс должен быть связан с сервисом
- Высокая вероятность ошибки конфигурации
- Нет инструментов длā работы с политиками из коробки
- Низкие накладные расходы
- Безопасность никогда не бывает удобной


__Термины SELinux__
- Субъект - пользователь или процесс, то есть то, что выполняет действия в системе
- Объект - то над чем выполняются действия, то есть файлы, порты, сокеты и прочее
- Режимы (policy) SELinux:
     - targeted - набор политик по умолчанию (включает MCS)
     - minimum — вариант targeted, минимальный набор политик
     - mls - MLS (уровни секретности)

## Доступ
### Дискреционный механизм доступа
Дискреционный механизм доступа (DAC, Discretionary Access Control)
- Каждый файл имеет владельца
- Владелец может передавать права
- Владелец, группа, остальные
- Расширение: POSIX ACL

### Мандатный механизм доступа
Мандатный механизм доступа (MAC, Mandatory Access Control, матричное управление доступом)
- Явные права на объекты (файлы, устройства, сокеты, порты, процессы)
- Права определяются политиками, а не владельцем
- Модель управления правами домен-тип (домен процесса, тип данных)
- Вариант в Debian: AppArmor


#### Механизмы мандатного доступа
1. MLS (Multi-Level Security, многоуровневая система безопасности)
- Модель Белла-Лападулы
- Уровни доступа (секретности)
- Объекты маркируются уровнями доступа         

__Уровни секретности__ 
- Все субъекты и объекты имеют свой уровень допуска
- Субъект с определенным уровнем допуска имеет право читать и создавать (писать/обновлять) объекты с тем же уровнем допуска. Кроме того, он имеет право читать менее секретные объекты и создавать объекты с более высоким уровнем
- Субъект никогда не сможет создавать объекты с уровнем допуска ниже, чем он сам имеет, а также прочесть объект более высокого уровня допуска
- Краткая формулировка: «write up, read down» и «no write down, no read up»
- Применяется при повышенных требованиях к безопасности (гос. и военные)
- Работает в режиме mls



- MCS (Multi-Category Security, мультикатегорийная система безопасности)
    - Данные разбиты на категории
    - Объектам назначается метки категорий
- RBAC (Roles Based Access Control) - управление доступом на основе ролей
- TE (Type Enforcement) - принудительная типизация доступа 
