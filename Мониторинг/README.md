# МОНИТОРИНГ
_ _ _
**Мониторинг** — система постоянного наблюдения за процессами происходящими в операционной системе.    

**Принципы** **мониторинга**
- Собирать максимальное количество данных (метрик)
- Хранить данные для последующего анализа
- Для критичных параметров настраивать уведомления
- Минимизация ложных срабатываний
- Контроль накладных расходов
- Удобство работы (визуализация, поиск, интерфейс)
- Мониторинг системы мониторинга     

**Ожидания от мониторинга**    
- Оповещения о сбоях в системе => Сбор информации о текущем состоянии
- Предупреждения о возможных сбоях и проблемах
- Сбор статистики и визуализация
- Отчеты
- Красивые дашборды

**Blackbox-мониторинг**    
Мониторинг, оценивающий внешнее состояние системы/сервиса    
- ping
- HTTP Request
- Открытый порт
- Наличие процессов     

**Whitebox-мониторинг**     
Мониторинг, базирующийся на метриках, которые дает само приложение (сервис)     
- через логи (журнал протоколирования)
- интерфейсы
- API
- SNMP    

**Метрики**
● Основные метрики системы
   ○ LoadAvg, CPU, Net (bps/pps), DISK Load
   ○ Потребление Mem/DISK
   ○ “Чистота” системных логов (dmesg/messages)
   ○ Актуальность и состояние резервных копий
● Метрики процесса
   ○ Наличие процесса и правильное количество этих процессов
   ○ Открытый сокет/порт процесса
   ○ Статус процесса (где есть возможность получить)
● Метрики сервиса
   ○ “Диагностический запрос”, который взаимодействует все или большинство компонентов
   ○ Время отклика/обработки запроса
   ○ Количество обращений в единицу времени
   ○ Количество одновременных обращений

## Локальный мониторинг
Мониторинг на самом хосте.   

**Утилиты** **мониторинга:**
- Общая нагрузка (CPU, RAM): top
- Память: free -h
- Дисковое пространство: du . -hs, df -ih
- Нагрузка на диски: iotop
- Использование сети:iptraf
- Комплексный мониторинг с историей: atop
- Профилирование нагрузки: perf    

## Распределенный мониторинг
Требуется когда много хостов. Есть сервер с ПО мониторинга, на хосты ставится агент.   

**Популярные** **системы** **мониторинга**
- Nagios
- Zabbix
- Cacti
- Icinga
- Prometheus + Grafana
