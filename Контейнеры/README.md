# КОНТЕЙНЕРИЗАЦИЯ
_ _ _
- Метод легковесной виртуализации процессов
- В основе — изоляция процессов через cgroups, namespaces и другие механизмы
- Используется только одно ядро хостовой ОС
- Возможны ограничениā ресурсов по CPU, RAM, сети и т.д.
- Реализации:    
○ Docker    
○ LXC    
○ OpenVZ (Virtuozzo)    
    

Обыкновенно в контейнер записывают не более одного приложения и всё, что нужно для его  работы - библиотеки (зависимости). Из этого вытекают все плюсы контейнеризации - приложение "обособленно" от ОС, если в ОС происходят изменения, обновления и т.д то в контейнере ничего не изменится, все зависимости останутся прежними.

## Средства изоляции
1.Пространства имён (namespaces) - с помощью namespaces мы изолируем процессы в различных областях
- PID PID процессов
- NETWORK Сетевые устройства, стеки, порты и т.п.
- USER ID пользователей и групп
- MOUNT Точки монтирования
- IPC System V IPC, очереди сообщений POSIX
- UTS Имя хоста и доменное имя NIS
2. Контрольные группы (cgroups) ограничение ресурсов - контролируем выделяемы ресурс
- использование памяти, в том числе виртуальной
- приоритизация: разным группам можно выделить разное количество процессорного ресурса
- пропускной способности подсистемы ввода-вывода

### Chroot
 __Chroot (Changeroot)__ - это подмена корня файловой системы для процесса (системный вызов) подменяет местонахождение корня файловой системы, заключая программу в специально созданное ограниченное окружение (jail) Любые обращения к файлам за пределами этой системы будут запрещены.
    
- разбирает аргументы командной строки
- выполняет системный вызов chroot
- выполняет переход в другой каталог
- изменяет пользователя, от имени которого необходимо выполнить действия
- выполняет заданную команду, а если команды нет, то запускает интерпретатор командной строки по умолчанию

__Недостатки Chroot__
- Общее пространство процессов - процесс запущенный в chroot видит все остальные процессы
- Общая сеть - невозможно запустить изолированные серверы в разных chroot
- Нельзя назначить лимиты по ресурсам - в любой момент процесс из chroot может занять все ресурсы

__Где используется сейчас__
- Тестирование программ - chroot можно использовать для тестирования программ в безопасной среде, где они не могут повредить хост-систему
- Восстановление системы - chroot можно использовать для восстановления системы после сбоя или вредоносной атаки
- Управление разрешениями - сhroot можно использовать для ограничения доступа пользователей к определнным файлам и каталогам на сервере



По мимо chroot, существует системный вызов pivot_root. С точки зрения безопасности у pivot_root есть преимущества, поэтому на практике при реазлизации среды управления контейнерами будет
использован pivot_root

### Namespaces
Пространство имен(namespace) это возможность ядра Linux предоставить процессу изолированный инстанс глобальных ресурсов. Изменения в изолированном представлении глобальных ресурсов видны только членам этого пространства имен, и не видны остальным процессам.      


Namespaces (пространства имен) — это абстракция (программная прослойка) над физическими ресурсами. Если раньше процессы обращались напрямую к ресурсам, то с появлением namespaces, все запросы проходят через этот дополнительный слой абстракции.       


Пространства имён используются для изоляции процессов     


__Namespaces - типы__
- Mount — абстракция над пространством имен для файловых систем.
- Network — абстракция над сетью
- IPC — абстракция над межпроцессным взаимодействием.
- PID — абстракция над пространством номеров процессов.
- User — абстракция над пространством пользователей.
- UTS (Unix Time Sharing) — абстракция над пространством hostname и NIS.
- Cgroup — используется как атрибут, корневой узел дерева cgroup.

