__Термины резервного копирования__   
- RTO (Recovery Time Objective) - определяет время, требуемое на восстановление из резервной копии. Это не то, что диктуется процессом РК, что=то требование, которому процесс должен соответствовать. Например, “восстановление из РК должно занимать
не более 1 часа”.
- RPO (Recovery Point Objective) - точка во времени (Point in Time), на которую должны быть восстановлены данные. Например, “Данные должны быть восстановлены по состоянии не “дальше”, чем 24 часа с момента сбоя”.
- Уровень резервного копирования (Backup Level) - 0-1-2, Full, Differential, Incremental. Различные стратегии выбора данных для копирования.
- Глубина резервного копирования - определяет как долго хранятся резервные копии.
- Стратегия хранения - определяет “детализацию”, с которой можно восстановиться.

__Уровни резервного копирования__     
- Full - полное резервное копирование. Для восстановлениā требуется только эта резервная копия.
- Differential - разностное резервное копирование. Копируется только то, что изменилось с последнего резервного копирования. Для восстановления требуется последняя полная и последняя дифференциальная копии.
- Incremental - инкрементальное резервное копирование. Копируется только то, что изменилось с последнего прохода резервного копирования. Для восстановления требуется: последняя полная; последняя дифференциальная (если есть); ВСЕ инкрементальные копии с момента последней полной/дифференциальной копии.


__Требования к системе РК__  
- Автоматизация
- Хранение на отдельном носителе или в другом месте
- Надежность места хранения
- Доступность места хранения
- Простота использования


__Вопросы для планирования РК__    
- Репликация/Дублирование
- От каких сбоев мы хотим защититься? (Зачем?)
- Что надо копировать?
- Как быстро надо восстанавливать? (RTO)
- На сколько “близко” точка восстановления? (RPO)
- Где все это хранить?
- Сколько это стоит?


__Правило 3-2-1 для бекапов__     
- Имейте не менее трех копий данных
- Храните копии как минимум на двух физических носителях разного типа
- Одну копию храните удаленно, вне офиса


__Сопутствующие действия__    
- Проверка целостности копий/проверка хранилища
- Мониторинг:
   - Хранилища
   - Агентов
   - ПО
   - Процесса
- Проверка восстанавливаемости    

## Создание бекапов с помощью утилит
### Руxное копирование
Основные проблемы:
- Создание упорядоченного архива (решается `date+format`)
- Удаленное хранение (решается с помощью SSH, NFS)


Инструменты:
- tar
- rsync
- dump
- dd
- rsync + inotify = lsyncd
- https://clonezilla.org/
- https://serveradmin.ru/kvm-backup/


__Утилиты копирования__      
С помощью утилиты tar (архивирование)
```
tar -czvf nginx_conf.tar.gz /etc/nginx
```
С помощью утилиты dd (побайтовое копирование)
```
dd if=/dev/sdb of=/mnt/backup/sdb.img
```
С помощью утилиты rsync
```
rsync -av --delete /etc/ /mnt/backup/hostname/etc
rsync -az -e ssh --delete user@192.168.2.1:/etc/nginx/ /etc/nginx
```

