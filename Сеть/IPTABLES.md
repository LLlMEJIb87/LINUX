# IPTABLES
Iptables - это мощный инструмент управления сетью в Linux, который позволяет администраторам управлять входящими и исходящими пакетами данных. Это основной инструмент для настройки межсетевых экранов в системах Linux.    

Iptables работает путем проверки пакетов данных на соответствие определенным критериям и выполнения заданных действий, если пакеты соответствуют этим критериям. Эти критерии и действия определяются в таблицах, которые состоят из набора правил. 
  
В Iptables есть четыре основные таблицы:
1. **Filter** - это основная таблица, используемая для фильтрации пакетов.
2. **NAT** - эта таблица используется для настройки NAT (Network Address Translation).
3. **Mangle** - эта таблица используется для специальной обработки пакетов.
4. **Raw** - эта таблица используется для обхода системы отслеживания состояний.

Каждая таблица состоит из набора цепочек. Цепочки - это последовательности правил, которые применяются к пакетам. В Iptables есть три встроенные цепочки:
1. **INPUT** - эта цепочка применяется к пакетам, которые предназначены для самой системы.
2. **FORWARD** - эта цепочка применяется к пакетам, которые проходят через систему.
3. **OUTPUT** - эта цепочка применяется к пакетам, которые исходят из системы.
<p align="center">
<image src="https://github.com/LLlMEJIb87/LINUX/blob/main/%D0%A1%D0%B5%D1%82%D1%8C/picture/chain.PNG">
</p>
   
## Фильтрация пакетов
<p align="center">
<image src="https://github.com/LLlMEJIb87/LINUX/blob/main/%D0%A1%D0%B5%D1%82%D1%8C/picture/filter.PNG">
</p>

### Команды
- iptables -nvL – просмотр списка правил ( по умолчанию смотрим таблицу FILTER, если нужна другая - iptables -nvL -t nat)
- iptables -F – сброс правил (политика остаётся)
- iptables -P – установка политики по умолчанию
- iptables -I – вставить правило в начало списка
- iptables -A – добавить правило в конец списка
- iptables -D – удалить правило

## Базовая настройка фильтрации трафика
```
iptables -A INPUT -p tcp --dport=22 -j ACCEPT  разрешили подключение по SSH 
```
```
iptables -A INPUT -p icmp -j ACCEPT - разрешаем протокол ICMP
```
```
iptables -I INPUT -i lo -j ACCEPT - полностью разрешаем локальный трафик ( -I -внести правило в начало списка)
```
```
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT разрешить входящий трафик, который был инициирован приложением 
```
**(После настройки правил, меняем политику входящего трафика с разрешающей на запрещающую)**
```
iptables -P INPUT DROP
```
