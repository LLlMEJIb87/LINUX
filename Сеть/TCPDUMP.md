# TCPDUMP
_ _ _
## Berkeley Packet Filter
Модуль отбора пакетов, реализуемый командой "bpf", позволяет захватить необходимые сетевые пакеты, проходящие через любой интерфейс системы, и направить их на удалённую рабочую станцию для дальнейшего анализа. Отбор пакетов производится путём их дублирования и не мешает обычной работе маршрутизатора.

<p align="center">
<image src="https://github.com/LLlMEJIb87/LINUX/blob/main/%D0%A1%D0%B5%D1%82%D1%8C/picture/BPF.PNG">
</p>

## TCPDUMP
tcpdump (от TCP и англ. dump — свалка, сбрасывать) — утилита UNIX, позволяющая перехватывать и анализировать сетевой трафик, проходящий через компьютер, на котором запущена данная программа.

**Основные** **параметры:**
- tcpdump -D # Список доступных интерфейсов
- tcpdump -n # Использовать ip- адреса (без Доменного имени) -nn - уберет и наименование протокола, заменив его на порт
- tcpdump -c <n> # Закрыть после перехвата n-пакетов
- tcpdump -i <ifname> # Использовать интерфейс
- tcpdump -A # Выводить все пакеты в формате ASCII
- tcpdump -w <file> # Сохраняет данные в двоичном формате в файл
- tcpdump -r <file> # Прочесть трафик из файла
- tcpdump -vvv # Вывод максимально подробной информации

**Примеры**   
tcpdump -i eth0 - смотрим весь трафик на интерфейсе    

tcpdump -i eth0 -nn 'src host 176.106.243.110 and not port 22' - смотрим  трафик(кроме ssh)  приходящий на eth0 от источника 176.106.243.110    

tcpdump -i eth0 -nn 'dst host 176.106.243.110 and not port 22'- смотрим  трафик(кроме ssh)  с eth0 до dst 176.106.243.110     

tcpdump -nn ‘host 1.1.1.1 and icmp’ - Смотрим ICMP-трафик с определенным хостом    

tcpdump -nn port 53 - Смотрим DNS-запросы

