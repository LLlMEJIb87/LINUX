# Логирование
_ _ _
**Задачи** **журналирования:**
- Фиксация событий системы и сервисов (syslog)
- Аудит — событий безопасности, инциденты (auth.log)
- Исходные данные для мониторинга после агрегации (access.log)
- Отладка проблем и поиск сбоев (error.log)
- Восстановление действий до указанного момента (binlog)
- Аналитика и поведение пользователей (access.log)
- Сценарий для нагрузочного тестированиā (access.log)

  ## Типы логов
Типы логов
1. Текстовые
- Прямой записи: /var/log/nginx/access.log
- Через rsyslogd: /var/log/syslog или /var/log/messages
2. Бинарные (через systemd-journald): /var/log/journal/
3. База данных (Elasticsearch, MySQL)

  ### Текстовые логи 
- __/var/log/syslog или /var/log/messages содержит глобальный системный журнал, в котором пишутся сообщения с момента запуска системы, от ядра Linux, различных служб, обнаруженных устройствах, сетевых интерфейсов и много другого.__
- /var/log/auth.log или /var/log/secure — информация об авторизации пользователей, включая удачные и неудачные попытки входа в систему, а также задействованные механизмы аутентификации.
- /var/log/dmesg — драйвера устройств. Одноименной командой можно просмотреть вывод содержимого файла. Размер журнала ограничен, когда файл достигнет своего предела, старые сообщения будут перезаписаны более новыми. Задав ключ --level= можно отфильтровать вывод по критерию значимости    
- /var/log/alternatives.log — Вывод программы update-alternatives, в котором находятся символические ссылки на команды или библиотеки по умолчанию.
- /var/log/anaconda.log — Записи, зарегистрированные во время установки системы.
- /var/log/audit — Записи, созданные службой аудита auditd.
- /var/log/boot.log — Информация, которая пишется при загрузке операционной системы.
- /var/log/cron — Отчет службы crond об исполняемых командах и сообщения от самих команд.
- /var/log/cups — Все, что связано с печатью и принтерами

__Для каждого дистрибутива будет отдельный журнал менеджера пакетов.__     
- /var/log/yum.log — Для программ установленных с помощью Yum в RedHat Linux.
- /var/log/emerge.log — Для ebuild-ов установленных из Portage с помощью emerge в Gentoo Linux.
- /var/log/dpkg.log — Для программ установленных с помощью dpkg в Debian Linux и всем семействе родственных дистрибутивах.

__Бинарные журналы учета пользовательских сессий.__
- /var/log/lastlog — Последняя сессия пользователей. Прочитать можно командой last.
- /var/log/tallylog — Аудит неудачных попыток входа в систему. Вывод на экран с помощью утилиты pam_tally2.
- /var/log/btmp — Еже один журнал записи неудачных попыток входа в систему. Просто так, на всякий случай, если вы еще не догадались где следует искать следы активности взломщиков.
- /var/log/wtmp — Еще один журнал записи входа пользователей в систему. Вывод на экран командой utmpdump.     


__Поддерживаемые уровни журналирования (приоритеты):__
- emerg - система неиспользуемая
- alert - действие должно быть произведено немедленно
- crit - условия критичности
- err - условия ошибок
- warn - условия предупреждений
- notice - обычные, но значимые условия
- info - информационный
- debug - отладочные сообщения

```
cat syslog | grep err  - фильтрация логов
```
```
tail -n 10 syslog  - показать последние 10 строк
```
```
tail -f syslog - смотреть лог в реальном времени
```
```
head -n 10 syslog - показать первые 10 строк лога
```



### dmesg
Команда dmesg показывает кольцевой буфер сообщений ядра — это логи, которые записывает ядро Linux о загрузке системы, обнаружении оборудования, подключении устройств, драйверах и других системных событиях.
```
dmesg -T
```





