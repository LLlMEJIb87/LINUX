# rsyslog

rsyslog — это системный журнал (syslog-сервер) и клиент, который собирает, фильтрует, сохраняет и/или передаёт логи (журналы событий) в Linux-системах. Он является улучшенной и более производительной версией классического syslog. 
   
__Как работает rsyslog__
1. Программа (например sshd, cron, kernel) пишет сообщение в системный журнал.
2. Это сообщение попадает в rsyslogd (демон rsyslog).
3. rsyslog анализирует сообщение и:
- сохраняет его в файл,
- передаёт на другой сервер,
- или игнорирует — в зависимости от конфигурации.

__/etc/rsyslog.conf__ - конфигурационный файл в котором можно настроить сбор логов   
__/etc/rsyslog.d/*.conf__ - Дополнительные конфиги (в Ubuntu)    

__Пример конфигурации__
```
# Логировать все сообщения mail-сервиса уровня warning и выше в отдельный файл
mail.warning    /var/log/mail.warn

# Отправлять все сообщения уровня error и выше на удалённый syslog-сервер
*.err    @@192.168.1.10:514
```

## Модули rsyslog
rsyslog  строится по модульной архитектуре, и именно за счёт модулей он стал таким мощным инструментом логирования.    

Модули — это плагины, которые расширяют функциональность rsyslog. Их можно загружать в конфигурации и использовать для:
- приёма сообщений (input)
- отправки сообщений (output)
- обработки сообщений (parser, filter)
- форматов, протоколов, баз данных и т.д.     

Каждый модуль `rsyslog` начинается с префикса, который определяет его назначение:

| Префикс | Назначение                 | Примеры             |
|---------|----------------------------|---------------------|
| `im`    | **Input module** — модуль ввода, принимает логи | `imudp`, `imtcp`, `imjournal` |
| `om`    | **Output module** — модуль вывода, отправляет логи | `omfile`, `omfwd`, `omelasticsearch` |
| `mm`    | **Message Modifier** — модуль изменения сообщений | `mmnormalize` |
| `pm`    | **Parser module** — модуль разбора сообщений     | `pmjsonparse`, `pmrfc5424` |
| `fm`    | **Function module** — вспомогательные функции     | специфичные модули |
